name: Terraform Databricks

on:
 push:
   branches: [main]

jobs:
 terraform:
  runs-on: ubuntu-latest

  steps:
   - uses: actions/checkout@v3

   - uses: hashicorp/setup-terraform@v2

   - run: terraform init
     working-directory: terraform

   - run: terraform apply -auto-approve
     working-directory: terraform
     env:
       ARM_CLIENT_ID: ${{ secrets.AZ_CLIENT_ID }}
       ARM_CLIENT_SECRET: ${{ secrets.AZ_CLIENT_SECRET }}
       ARM_TENANT_ID: ${{ secrets.AZ_TENANT_ID }}
       ARM_SUBSCRIPTION_ID: ${{ secrets.AZ_SUBSCRIPTION_ID }}